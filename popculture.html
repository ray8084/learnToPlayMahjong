<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pop Culture - Modern Mahjong</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="instructors.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyBlSaKTCsxx0uLlYPSAaox0U7oEmufeCDw",
            authDomain: "learntoplaymahjong.firebaseapp.com",
            projectId: "learntoplaymahjong",
            storageBucket: "learntoplaymahjong.firebasestorage.app",
            messagingSenderId: "687624422357",
            appId: "1:687624422357:web:1234567890abcdef"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        
        console.log('Firebase initialized successfully');
        console.log('Firebase config:', firebaseConfig);
        console.log('Auth object:', auth);
        
        let authChecked = false;
        
        onAuthStateChanged(auth, (user) => {
            if (!authChecked) {
                setTimeout(() => {
                    authChecked = true;
                    if (!user) {
                        console.log('No authenticated user, redirecting to home page');
                        window.location.href = 'index.html';
                    } else {
                        console.log('User authenticated:', user.email);
                    }
                }, 500);
            }
        });
        
        window.showLoginForm = function() {
            const modal = document.getElementById('authModal');
            modal.style.display = 'block';
        };
        
        window.closeModal = function() {
            const modal = document.getElementById('authModal');
            modal.style.display = 'none';
        };
        
        window.login = async function() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            try {
                await signInWithEmailAndPassword(auth, email, password);
                document.getElementById('authModal').style.display = 'none';
                console.log('Login successful');
            } catch (error) {
                alert('Login failed: ' + error.message);
            }
        };
        
        window.signup = async function() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            try {
                await createUserWithEmailAndPassword(auth, email, password);
                document.getElementById('authModal').style.display = 'none';
                console.log('Signup successful');
            } catch (error) {
                alert('Signup failed: ' + error.message);
            }
        };
        
        window.logout = async function() {
            try {
                await signOut(auth);
                window.location.href = 'index.html';
            } catch (error) {
                console.error('Logout failed:', error);
            }
        };
        
        window.toggleUserMenu = function() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        };
        
        window.nextPage = function() {
            // Placeholder for next lesson
            alert('This will be the next lesson when ready');
        };
        
        window.previousPage = function() {
            window.location.href = 'resurgence.html';
        };
        
        // Close dropdown when clicking outside
        window.onclick = function(event) {
            if (!event.target.matches('.user-icon')) {
                const dropdown = document.getElementById('userDropdown');
                if (dropdown.classList.contains('show')) {
                    dropdown.classList.remove('show');
                }
            }
        };
    </script>
</head>
<body class="popculture-page">
    <!-- User Menu -->
    <div class="user-menu">
        <div class="user-icon" onclick="toggleUserMenu()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
        </div>
        <div class="user-dropdown" id="userDropdown">
            <div class="user-info">
                <span id="userEmail">User</span>
            </div>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item" onclick="logout()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16,17 21,12 16,7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Logout
            </button>
        </div>
    </div>

    <div class="popculture-main">
        <div class="popculture-container">
            <div class="popculture-header">
                <img src="pop.png" alt="POP!" class="pop-image">
                <h1 class="popculture-title">CULTURE</h1>
                <img src="Amy.png" alt="Amy" class="amy-image">
            </div>
            <ul class="popculture-bullets">
                <li>On our YouTube channel, one of our playlists is Fun Mahjong Find Friday where we share videos and clips of celebrities playing mahjong, the game in the news, and in movies and media.</li>
                <li>Many celebrities that share their love of the game on social media and in interviews include Fran Drescher, Sarah Jessica Parker, Amy Poehler, and Julia Roberts to name a few!</li>
                <li>Mahjong has been featured in many movies including:
                    <ul class="movie-list">
                        <li>A Walk on the Moon</li>
                        <li>Blue Bloods</li>
                        <li>Driving Miss Daisy</li>
                        <li>Grace and Frankie</li>
                        <li>Modern Family</li>
                        <li>Seinfeld</li>
                        <li>The Joy Luck Club</li>
                        <li>and many more!</li>
                        <li>You can see these videos on YouTube.com/ModernMahjong</li>
                    </ul>
                </li>
            </ul>
            
            <div class="fine-print">
                <p>THIS PRESENTATION AND DOCUMENT ARE THE PROPERTY OF MODERN MAHJONG AND ONLY FOR THE USE FOR EDUCATIONAL PURPOSES FOR OUR STUDENTS.</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="button-container">
            <div class="footer-buttons">
                <button class="back-btn" onclick="previousPage()">Back</button>
                <button class="login-btn" onclick="nextPage()">Next</button>
            </div>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div id="authModal" class="auth-modal" style="display: none;">
        <div class="auth-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Login / Sign Up</h2>
            <input type="email" id="email" placeholder="Email" required>
            <input type="password" id="password" placeholder="Password" required>
            <button onclick="login()">Login</button>
            <button onclick="signup()">Sign Up</button>
        </div>
    </div>
</body>
</html>
